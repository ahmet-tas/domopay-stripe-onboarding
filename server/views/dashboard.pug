extends layout

block header
  if showBanner
    .banner
      .message
        strong Klasse! Ihr Zugang ist nun eingerichtet. 
        span.secondary-text Fangen Sie gleich an mit Ihren Leistungen Geld zu verdienen.
block content
  .dashboard
    .user
      .block.profile
        .photo
        p Konto seit #{moment(serviceVendor.created).format('MMM YYYY')}
        h1 #{serviceVendor.displayName()}
        h2
          a(href='/serviceVendors/stripe/dashboard?account=true') Stripe Account anzeigen

      .block.week
        p Diese Woche
        h1 €#{(offeringsTotalAmount / 100).toFixed(2)}
        h2 #{offerings.length} Aufträge
      .block.available
        p Ihr Kontostand
        h1 #{balanceCurrency}#{((balanceAvailable + balancePending) / 100).toFixed(2)}
        h2  #{balanceCurrency}#{(balanceAvailable / 100).toFixed(2)} verfügbar
      .block.stripe
        form.payout(action='/serviceVendors/stripe/payout', method='POST', autocomplete='off')
          input(class='primary' type='submit', value='Auszahlung anfordern' disabled=(balanceAvailable===0))
        p
          a(href='/serviceVendors/stripe/dashboard') Auszahlungen in Stripe öffnen
    section.offerings
      h4 Vergangene Aufträge
      if offerings.length > 0
        .list
          each offering in rides
            .row
              .cell.name= offering.customer.displayName()
              .cell.date= moment(new Date(Date.parse(offering.created))).calendar()
              .cell.price €#{(offering.amountForServiceVendor() / 100).toFixed(2)}
      else
        .no-offerings
          .rocket
          h1 Bisher keine Aufträge
          h2 &nbsp;
block footer
  .annotation.card.dashboard-banner(class=(showBanner ? '' : 'hidden'))
    h4 The Connect Express onboarding flow is now complete. 
      a.show-more(href="#") &nbsp;(show more)
    .description
      p Express includes the #[strong Stripe account ID] that was just created, so after the flow redirects to domopay we can save it to the database.
      p This account ID can then be used to #[a(href="https://stripe.com/docs/api/balance/balance_retrieve" target="_blank") retrieve the serviceVendor’s balance], provide a #[a(href="https://stripe.com/docs/connect/destination-charges" target="_blank") destination for payments], or #[a(href="https://stripe.com/docs/connect/payouts" target="_blank") create payouts].
    form.right
      button.primary-action.next Next step
  .annotation.card.dashboard-simulate(class=(showBanner ? 'hidden' : ''))
    h4 Simulate a customer offering to create a payment for this serviceVendor.
      a.show-more(href="#") &nbsp;(show more)
    .description
      ol
        li The balance is automatically fetched from the Stripe API.
        li #[strong View payouts on Stripe] lets serviceVendors see their payouts or edit their account information.
        li #[strong Pay out now] uses the Stripe API to #[a(href="https://stripe.com/docs/connect/payouts" target="_blank") generate a payout] of the available balance.
    form.right(action='/serviceVendors/offerings', method='POST', autocomplete='off')
      input(type='submit', name="immediate_balance", value='Auftrag erstellen', class='primary-action')